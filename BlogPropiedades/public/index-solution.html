<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog Propiedades - Soluci√≥n TDZ</title>
  
  <!-- CR√çTICO: Script de protecci√≥n TDZ - DEBE SER EL PRIMER SCRIPT -->
  <script>
    // SOLUCI√ìN TDZ INLINE - Definir variables cr√≠ticas inmediatamente
    (function() {
      // 1. Definir variables cr√≠ticas usando 'var' para hoisting global
      var y = {};
      var wi = {};
      var Fp = {};
      var Nc = {};
      
      // 2. Asignar a window para garantizar su disponibilidad
      window.y = y;
      window.wi = wi;
      window.Fp = Fp;
      window.Nc = Nc;
      
      console.log("üîí Variables cr√≠ticas 'y', 'wi', 'Fp', 'Nc' protegidas");
      
      // 3. Detector de errores TDZ para protecci√≥n adicional
      window.addEventListener('error', function(event) {
        if (event.message && event.message.includes('Cannot access') && 
            event.message.includes('before initialization')) {
          
          // Extraer nombre de la variable problem√°tica
          var matches = event.message.match(/'([^']+)'/);
          if (matches && matches[1]) {
            var varName = matches[1];
            
            // Inyectar inmediatamente mediante script
            var script = document.createElement('script');
            script.textContent = `
              // Definir variable problem√°tica
              var ${varName} = {}; 
              window.${varName} = window.${varName} || {};
              console.log("‚ö° Variable '${varName}' protegida mediante interceptor");
            `;
            document.head.appendChild(script);
            
            // Intentar prevenir propagaci√≥n
            event.preventDefault();
            event.stopPropagation();
            return true;
          }
        }
      }, true);
      
      // 4. Cargar script de soluci√≥n completa
      setTimeout(function() {
        var script = document.createElement('script');
        script.src = 'tdz-solution.js';
        document.head.appendChild(script);
      }, 0);
    })();
  </script>
</head>
<body>
  <div id="root"></div>
  
  <!-- Contenido para mostrar que las variables est√°n protegidas -->
  <script>
    window.addEventListener('DOMContentLoaded', function() {
      // Verificar estado de variables cr√≠ticas
      console.log('Estado de variables cr√≠ticas:');
      console.log('- y:', typeof y !== 'undefined' ? 'Definida ‚úÖ' : 'No definida ‚ùå');
      console.log('- wi:', typeof wi !== 'undefined' ? 'Definida ‚úÖ' : 'No definida ‚ùå');
      console.log('- Fp:', typeof Fp !== 'undefined' ? 'Definida ‚úÖ' : 'No definida ‚ùå');
      console.log('- Nc:', typeof Nc !== 'undefined' ? 'Definida ‚úÖ' : 'No definida ‚ùå');
      
      // Mostrar en la p√°gina
      var rootDiv = document.getElementById('root');
      rootDiv.innerHTML = `
        <div style="font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px;">
          <h1>Blog Propiedades - Soluci√≥n TDZ</h1>
          <div style="background-color: #f0f0f0; padding: 20px; border-radius: 5px;">
            <h2>Estado de protecci√≥n TDZ</h2>
            <ul>
              <li>Variable 'y': <strong>${typeof y !== 'undefined' ? 'Protegida ‚úÖ' : 'No protegida ‚ùå'}</strong></li>
              <li>Variable 'wi': <strong>${typeof wi !== 'undefined' ? 'Protegida ‚úÖ' : 'No protegida ‚ùå'}</strong></li>
              <li>Variable 'Fp': <strong>${typeof Fp !== 'undefined' ? 'Protegida ‚úÖ' : 'No protegida ‚ùå'}</strong></li>
              <li>Variable 'Nc': <strong>${typeof Nc !== 'undefined' ? 'Protegida ‚úÖ' : 'No protegida ‚ùå'}</strong></li>
            </ul>
          </div>
          
          <div style="margin-top: 20px;">
            <h2>Instrucciones para implementar en tu app React</h2>
            <ol>
              <li><strong>Incluye el script de protecci√≥n al inicio del HTML</strong>
                <p>Agrega el siguiente script como el primer script en la secci√≥n &lt;head&gt; de tu archivo HTML principal:</p>
                <pre style="background-color: #272822; color: #f8f8f2; padding: 10px; border-radius: 5px; white-space: pre-wrap; overflow-x: auto;"><code>&lt;script&gt;
  // SOLUCI√ìN TDZ INLINE - Definir variables cr√≠ticas
  (function() {
    // Definir variables cr√≠ticas con 'var'
    var y = {};
    var wi = {};
    var Fp = {};
    var Nc = {};
    
    // Asignar a window tambi√©n
    window.y = y;
    window.wi = wi;
    window.Fp = Fp;
    window.Nc = Nc;
    
    console.log("üîí Variables cr√≠ticas protegidas");
  })();
&lt;/script&gt;</code></pre>
              </li>
              
              <li><strong>Copia los scripts adicionales a tu carpeta p√∫blica</strong>
                <p>Copia estos archivos a la carpeta p√∫blica:</p>
                <ul>
                  <li><code>tdz-solution.js</code> - Soluci√≥n principal</li>
                  <li><code>react-component-patch.js</code> - Parche para componentes</li>
                </ul>
              </li>
            </ol>
          </div>
        </div>
      `;
    });
    
    // Probar acceso a variables protegidas
    setTimeout(function() {
      try {
        console.log("Prueba de acceso a 'y':", y ? "Acceso exitoso ‚úÖ" : "Fallo ‚ùå");
      } catch(e) {
        console.error("‚ùå Error al acceder a 'y':", e);
      }
    }, 1000);
  </script>
  
  <!-- Aqu√≠ ir√≠a normalmente el script de la aplicaci√≥n React -->
  <!-- <script type="module" src="/src/main.jsx"></script> -->
</body>
</html> 